data = {
    "website": "Drustvene igre",
    "ukupanBrojProizvoda": "0",
    "categories": [
        { 
            "name" : "Apstraktne strateške igre",
            "products" : [
                { 
                    "name" : "AZUL - MASTER CHOCOLATIER", "image" : "./../images/kategorija1/k1_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "PATCHWORK - VALENTINE'S DAY EDITION", "image" : "./../images/kategorija1/k1_2.webp", "kolicina" : "0"
                },                
                { 
                    "name" : "YINSH", "image" : "./../images/kategorija1/k1_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "WAR CHEST", "image" : "./../images/kategorija1/k1_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "HAVALANDI", "image" : "./../images/kategorija1/k1_5.webp", "kolicina" : "0"
                }
            ]
        },
        { 
            "name" : "Strateške igre",
            "products" : [
                { 
                    "name" : "7 WONDERS DUEL", "image" : "./../images/kategorija2/k2_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "A GAME OF THRONES: THE BOARD GAME - SECOND EDITION", "image" : "./../images/kategorija2/k2_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "ANKH: GODS OF EGYPT", "image" : "./../images/kategorija2/k2_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "AMSTERDAM", "image" : "./../images/kategorija2/k2_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "PANDEMIC (HR)", "image" : "./../images/kategorija2/k2_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Tematske igre",
            "products" : [
                { 
                    "name" : "ADVENTURE GAMES: MONOCHROME INC.", "image" : "./../images/kategorija3/k3_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "ADVENTURE GAMES: THE DUNGEON", "image" : "./../images/kategorija3/k3_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CARTAVENTURA: VINLAND", "image" : "./../images/kategorija3/k3_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CHRONICLES OF CRIME: 1900", "image" : "./../images/kategorija3/k3_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "MARVEL CHAMPIONS: THE CARD GAME", "image" : "./../images/kategorija3/k3_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Ratne igre",
            "products" : [
                { 
                    "name" : "ROOT: CLOCKWORK EXPANSION 2", "image" : "./../images/kategorija4/k4_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "DIPLOMACY", "image" : "./../images/kategorija4/k4_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "ROOT", "image" : "./../images/kategorija4/k4_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "AXIS AND ALLIES 1941", "image" : "./../images/kategorija4/k4_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "GENERAL ORDERS: WORLD WAR II", "image" : "./../images/kategorija4/k4_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Party igre",
            "products" : [
                { 
                    "name" : "CARDS AGAINST HUMANITY", "image" : "./../images/kategorija5/k5_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "COCKROACH POKER", "image" : "./../images/kategorija5/k5_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CODENAMES (HR)", "image" : "./../images/kategorija5/k5_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "DIXIT (HR)", "image" : "./../images/kategorija5/k5_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CORTEX: HARRY POTTER", "image" : "./../images/kategorija5/k5_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Obiteljske igre",
            "products" : [
                { 
                    "name" : "AZUL - MASTER CHOCOLATIER", "image" : "./../images/kategorija6/k6_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CARCASSONNE (HR)", "image" : "./../images/kategorija6/k6_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CATAPULT FEUD (HR)", "image" : "./../images/kategorija6/k6_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CATAN (HR)", "image" : "./../images/kategorija6/k6_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CLUEDO: DRACULA", "image" : "./../images/kategorija6/k6_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Igre s nadogradnjama",
            "products" : [
                { 
                    "name" : "MARVEL CHAMPIONS: ROGUE HERO PACK", "image" : "./../images/kategorija7/k7_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "LORD OF THE RINGS: THE CARD GAME - THE DREAM-CHASER CAMPAIGN EXPANSION", "image" : "./../images/kategorija7/k7_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "SHERLOCK HOLMES CONSULTING DETECTIVE: THE BAKER STREET IRREGULARS", "image" : "./../images/kategorija7/k7_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "VAMPIRE: THE MASQUERADE - BLOOD FEUD", "image" : "./../images/kategorija7/k7_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "MARVEL CHAMPIONS: THE GALAXY'S MOST WANTED EXPANSION", "image" : "./../images/kategorija7/k7_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Dječje igre",
            "products" : [
                { 
                    "name" : "HARRY POTTER: MISCHIEF IN DIAGON ALLEY", "image" : "./../images/kategorija8/k8_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "MY LIL EVERDELL", "image" : "./../images/kategorija8/k8_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CORTEX DISNEY (HR)", "image" : "./../images/kategorija8/k8_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CHRONICLES OF AVEL", "image" : "./../images/kategorija8/k8_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "ANDOR: THE FAMILY FANTASY GAME", "image" : "./../images/kategorija8/k8_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Roleplay igre",
            "products" : [
                { 
                    "name" : "DND DRAGONS OF STORMWRECK ISLE STARTER KIT", "image" : "./../images/kategorija9/k9_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CALL OF CTHULHU STARTER SET", "image" : "./../images/kategorija9/k9_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "DUNGEONS AND DRAGONS: KEYS FROM THE GOLDEN VAULT", "image" : "./../images/kategorija9/k9_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "DUNGEONS AND DRAGONS: EPIC MONSTER CARDS", "image" : "./../images/kategorija9/k9_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "CALL OF CTHULHU - DOORS TO DARKNESS", "image" : "./../images/kategorija9/k9_5.webp", "kolicina" : "0"
                }
            ]
        },
        {
            "name" : "Trading card igre",
            "products" : [
                { 
                    "name" : "YU GI OH! 25TH ANNIVERSARY TIN: DUELING HEROES", "image" : "./../images/kategorija10/k10_1.webp", "kolicina" : "0"
                },
                { 
                    "name" : "POKEMON - BATTLE ACADEMY", "image" : "./../images/kategorija10/k10_2.webp", "kolicina" : "0"
                },
                { 
                    "name" : "YU GI OH! INVASION OF CHAOS 25TH ANNIVERSARY EDITION BOOSTER", "image" : "./../images/kategorija10/k10_3.webp", "kolicina" : "0"
                },
                { 
                    "name" : "POKEMON PALDEA EVOLVED ELITE TRAINER BOX", "image" : "./../images/kategorija10/k10_4.webp", "kolicina" : "0"
                },
                { 
                    "name" : "ONE PIECE CARD GAME YAMATO STARTER DECK ST09", "image" : "./../images/kategorija10/k10_5.webp", "kolicina" : "0"
                }
            ]
        }
    ]
}



// globalne varijable:
let prijasnjiId = 1;



// !!! JS za promena kategorije:

    //iteriram po svim mogucim kategorijama i svima posatvljam da slusaju na click, zj postavljam im event listener
for(let i = 1; i <= 10; i++) {
    let kategorija = document.getElementById(i);

    kategorija.addEventListener("click", function() {
                                        obradaKategorije(kategorija.id);
                                        } );
}

function obradaKategorije(noviId) {
    //svaki put kad s eprebaci nova kategorija potebno je proc po svim proizvodima, ucitat u njih odgovarajuce vriejndosti borjaca
    // i ako su 0 onda display: none;
    let j = 0;
    for(let brojac of document.querySelectorAll(".brojilo-proizvod")) {
        brojac.innerHTML = data.categories[noviId - 1].products[j].kolicina;
        j++;
        //ukoliko je kolicina 0 uagasi brojac, a ako je razlicit od 0 onda ga ukljuci:
        if(Number(brojac.innerHTML) == 0) {
            brojac.style.display = "none";
        }
        if(Number(brojac.innerHTML) != 0) {
            brojac.style.display = "flex";
        }
    }

    let prijasnjaKategorija = document.getElementById(prijasnjiId);

    prijasnjaKategorija.style.fontWeight = 500;

    let novaKategorija = document.getElementById(noviId);
    novaKategorija.style.fontWeight = 600;

    //trebat ce u prijansji id sprmeit noviId

    //mijenjanje samog dijela sa proizvodima
    let imeKategorije = document.querySelector(".ime-trenutne-kategorije");
    let tekstImena = imeKategorije.innerHTML;
    let uvijekIsti = tekstImena.slice(0, 22);
    
    let noviTeskt = uvijekIsti + data.categories[noviId - 1].name;
    imeKategorije.innerHTML = noviTeskt;

    //mijenajnje proizvoda
    let proizvodi = document.querySelectorAll(".proizvod-slika-opis");

    let i = 0;
    for(let proizvod of proizvodi) {
        proizvod.firstElementChild.firstElementChild.src = data.categories[noviId - 1].products[i].image;
        proizvod.lastElementChild.innerHTML = data.categories[noviId - 1].products[i].name;

        i++;
    }

    prijasnjiId = noviId;
}


// !!! JS da se kosarica prikaze kada se dode iznad itema, i mkane kada se makne sa itema
for(let slika of document.querySelectorAll(".proizvod-slika")) {
    slika.addEventListener("mouseover", function(){
                                        prikaziCart(slika);
                                    });

    slika.nextSibling.nextSibling.addEventListener("mouseover", function(){
        prikaziCart(slika);
    });

    slika.addEventListener("mouseout", function(){
                                        makniCart(slika);
                                    });
}
                      
function prikaziCart(slika) {
    console.log(slika.nextSibling.nextSibling.style.display = "inline-block");
}

function makniCart(slika) {
    console.log(slika.nextSibling.nextSibling.style.display = "none");
}



// !!! JS da se stvari dodaju u kosarice

// u ovaj dio se uvijek pozivaju addEventListener koji se jendom postave i dalje sami znaju funkcionirat kad se event desi
for(let cart of document.querySelectorAll(".cart-proizvod")) {
    cart.addEventListener("click", function(){
                                obradiPoveacnjeProizvoda(cart);
                                 });
} 

function obradiPoveacnjeProizvoda(cart) {

    //dio koda di se prepozna odgovarajuci elment i poveca se za 1:

    let idProizvod = cart.previousElementSibling.id;
    let indexProizvod = idProizvod.slice(1,2) - 1;
    console.log(indexProizvod);

        //povecanje vrijednostina odgovarajucoj poziciji za 1
    let prije = data.categories[prijasnjiId - 1].products[indexProizvod].kolicina;
    let poslije = Number(prije) + 1;
    data.ukupanBrojProizvoda++;
    data.categories[prijasnjiId - 1].products[indexProizvod].kolicina = poslije;

    console.log(data.categories[prijasnjiId - 1].products[indexProizvod].kolicina);

    //cim si kliko znaic da se odmah odgovrajuca kolicina povecala na vise od nula
    let brojiloProizvod = cart.nextSibling.nextSibling;

        //u tom istom borjilu se treba povecat vrijendost:
    brojiloProizvod.innerHTML = data.categories[prijasnjiId - 1].products[indexProizvod].kolicina;
    brojiloProizvod.style.display = "flex";

    //Js za prikaziavnje carta:
    let cartZaglavlje = document.querySelector(".brojilo-cart");
    cartZaglavlje.innerHTML = data.ukupanBrojProizvoda;
        // takoder ako se aktivirala ova funkcija to zanic da je barem jedna priutan, pa mogu uvijek samo aktivitat
    cartZaglavlje.style.display = "flex";

}






// !!! da se stvari spremaju i lodaju svakiput kad se stranica apokrene:


// Funkcija za spremanje podataka u lokalni spremnik
function spremiPodatke(data) {
    localStorage.setItem('mojiPodaci', JSON.stringify(data));
}

// Funkcija za dohvaćanje podataka iz lokalnog spremnika
function dohvatiPodatke() {
    var spremljeniPodaci = localStorage.getItem('mojiPodaci');
    if (spremljeniPodaci) {
        return JSON.parse(spremljeniPodaci);
    } else {
        return null;
    }
}

// Funkcija koja se poziva prilikom prije nego što se stranica napusti
window.addEventListener('beforeunload', function() {
    spremiPodatke(data);
});

// Funkcija koja se poziva kada se DOM učita na novoj stranici
document.addEventListener('DOMContentLoaded', function() {
    var data2 = dohvatiPodatke();
    localStorage.clear();
    if (data2) {
        //data = null;
        data = Object.assign({}, data2);

        console.log(data.categories[0].products[0].kolicina)
        prijasnjiId = 1;

        //obnovi podatke za brojila dolje:
        let j = 0;
        for(let brojac of document.querySelectorAll(".brojilo-proizvod")) {
            brojac.innerHTML = data.categories[prijasnjiId - 1].products[j].kolicina;
            j++;
            //ukoliko je kolicina 0 uagasi brojac, a ako je razlicit od 0 onda ga ukljuci:
            if(Number(brojac.innerHTML) <= 0) {
                brojac.style.display = "none";
            }
            if(Number(brojac.innerHTML) > 0) {
                brojac.style.display = "flex";
            }
        }

        //obnovi stanje za kosaricu
            document.querySelector(".brojilo-cart").innerHTML = data.ukupanBrojProizvoda;
            if(Number(data.ukupanBrojProizvoda) <= 0) {
                document.querySelector(".brojilo-cart").style.display = "none";
            }
            if(Number(data.ukupanBrojProizvoda) > 0) {
                document.querySelector(".brojilo-cart").style.display = "flex";
            }  

    }
});